/*SETTINGS BELOW THIS LINE*/const int MAX_SHIFT = 5400;const int basePressure = 155;const int baseShiftUp = 2500;const int baseShiftDown = 1500;const int Cylinders = 8; /*DO NOT EDIT BELOW THIS LINE (Unless you know what your editing)*/const int SOL_A = 3;const int SOL_B = 4;const int TCC = 5;const int PCS = 6;const int M_TCC = 7;const int M_UP = 8;const int M_DOWN = 9;const int LED1 = 2;const int LED2 = 10;const int LED3 = 11;const int LED4 = 12;const int TACH = 13;/* There is just no point in editing these unless your writing your own firmware */int crpm = 0;int gear = 1;int prs = 255;int tccv = 0;bool Manual = false;bool debug = false;float pls = 10;float ppms = 0;float pps = 0;float ppm = 0;float rpm = 0;float ms = 0;float pms = 0;int ppr = Cylinders / 2;void setup() {    pinMode(SOL_A, OUTPUT);    pinMode(SOL_B, OUTPUT);    pinMode(TCC, OUTPUT);    pinMode(PCS, OUTPUT);    pinMode(LED1, OUTPUT);    pinMode(LED2, OUTPUT);    pinMode(LED3, OUTPUT);    pinMode(LED4, OUTPUT);        pinMode(M_UP, INPUT);    pinMode(M_DOWN, INPUT);    pinMode(M_TCC, INPUT);    pinMode(TACH, INPUT);      prs = basePressure;}void loop() {  pls = pulseIn(TACH, HIGH);  digitalWrite(PCS, prs);  if (digitalRead(A5) == HIGH) {    Manual = true;  }else{    Manual = false;  }  if (Manual) {    if (digitalRead(M_UP)==HIGH) {      if (gear < 4) {        gear = gear + 1;        delay (150);      }    }else if (digitalRead(M_DOWN) == HIGH) {      if (gear >= 2) {        gear = gear - 1;        delay (150);      }    }else if (crpm >= MAX_SHIFT) {            if (gear < 4) {        gear = gear + 1;      }          }  }else{        if (crpm >= baseShiftUp) {      if (gear < 4) {        gear = gear + 1;      }    }else if (crpm >= baseShiftDown) {      if (gear >= 2) {        gear = gear - 1;      }    }else if (gear == 4) {      if ((crpm-250) >= baseShiftDown) {                  if (tccv < 255) {          tccv = tccv + 5;          delay(50);        }              }else if ((crpm-250) <= baseShiftDown && crpm >= baseShiftDown) {                 if (tccv > 5) {          tccv = tccv - 5;          delay(50);        }              }    }        if (!gear == 4) {      if (!digitalRead(M_TCC) == HIGH) {        tccv = 0;      }    }        if (crpm >= MAX_SHIFT) {            if (gear < 4) {        gear = gear + 1;      }          }      }    if (debug) {  Serial.print("pls: ");  Serial.print(pls);  Serial.println();}  ms = pls / 1000;  pms = 1/ms;    ppms = pms; //4.69483if (debug) {  Serial.print("ppms: ");  Serial.print(ppms);  Serial.println();}  pps = ppms * 1000;if (debug) {  Serial.print("pps: ");  Serial.print(pps);  Serial.println();}    ppm = pps * 60;if (debug) {  Serial.print("ppm: ");  Serial.print(ppm);  Serial.println();}    rpm = ppm / ppr;  if (gear == 1) {  digitalWrite(SOL_A, HIGH);  digitalWrite(SOL_B, HIGH);}else if (gear == 2) {  digitalWrite(SOL_A, LOW);  digitalWrite(SOL_B, HIGH);}else if (gear == 3) {  digitalWrite(SOL_A, LOW);  digitalWrite(SOL_B, LOW);}else if (gear == 4) {  digitalWrite(SOL_A, HIGH);  digitalWrite(SOL_B, LOW);}else if (gear >= 4) {  gear = 4;}else if (gear < 1) {  gear = 1;}  }//3200 RPM = 53.333 RPS = 213 PPS = .213 PPMS = 0.000213 PP_MICROSEC//1900 RPM = 31.66 RPS = 126.66666 PPS = .126666 PPMS = .0001266